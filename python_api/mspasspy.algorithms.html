

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>mspasspy.algorithms &mdash; MsPASS 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mspasspy.ccore" href="mspasspy.ccore.html" />
    <link rel="prev" title="Python API" href="index.html" />  

  <style>
    .wy-nav-content { max-width: 1600px; }
  </style>

  
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MsPASS
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/run_mspass_with_docker.html">Run MsPASS with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/deploy_mspass_with_docker_compose.html">Deploy MsPASS with Docker Compose</a></li>
</ul>
<p class="caption"><span class="caption-text">User Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/data_object_design_concepts.html">Data Object Design Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/time_standard_constraints.html">Time Standard Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/obspy_interface.html">Using ObsPy with MsPASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/database_concepts.html">Database Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/CRUD_operations.html">CRUD Operations in MsPASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/handling_errors.html">Handling Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/graphics.html">Graphics in MsPASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/processing_history_concepts.html">Processing History Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/adapting_algorithms.html">Adapting an Existing Algorithm to MsPASS</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference Manual</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Python API</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">mspasspy.algorithms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-mspasspy.algorithms.RFdeconProcessor">RFdeconProcessor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mspasspy.algorithms.signals">signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mspasspy.algorithms.window">window</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.ccore.html">mspasspy.ccore</a></li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.db.html">mspasspy.db</a></li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.graphics.html">mspasspy.graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.history.html">mspasspy.history</a></li>
<li class="toctree-l2"><a class="reference internal" href="mspasspy.util.html">mspasspy.util</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cxx_api/index.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mspass_schema/mspass_schema.html">MsPASS Schema</a></li>
</ul>

            
          
    <a href= "../genindex.html">Index</a>
  
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MsPASS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Python API</a> &raquo;</li>
        
      <li>mspasspy.algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/mspass-team/mspass/blob/master/docs/source/python_api/mspasspy.algorithms.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="mspasspy-algorithms">
<h1>mspasspy.algorithms<a class="headerlink" href="#mspasspy-algorithms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-mspasspy.algorithms.RFdeconProcessor">
<span id="rfdeconprocessor"></span><h2>RFdeconProcessor<a class="headerlink" href="#module-mspasspy.algorithms.RFdeconProcessor" title="Permalink to this headline">¶</a></h2>
<p>This file contains a class definition for a wrapper for
the suite of scalar deconvolution methods supported by mspass.
It demonstrates the concept of a processing object created
by wrapping C code.</p>
<p>Created on Fri Jul 31 06:24:10 2020</p>
<p>&#64;author: Gary Pavlis</p>
<dl class="py function">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdecon">
<code class="sig-prename descclassname">mspasspy.algorithms.RFdeconProcessor.</code><code class="sig-name descname">RFdecon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">processor</span></em>, <em class="sig-param"><span class="n">wavelet</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">noisedata</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wcomp</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">ncomp</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'RFdecon'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/RFdeconProcessor.html#RFdecon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdecon" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this function to compute conventional receiver functions
from a single three component seismogram.  The type of
processor is defined by the processor argument that is expected
to be an instance of the wrapper class RFdeconProcessor. In
mspass the processor class should be created and stored as a
global variable and passed to this function within a
spark map operator.  That allows the processing to proceed in
parallel without the overhead of creating the processor
definition for each seismogram.</p>
<p>Default assumes d contains all data sections required to do
the deconvolution with the wavelet in component 2 (3 for matlab
and FORTRAN people).  By default the data and noise
(if required by the algorithm) sections will be extracted from
the (assumed larger) data section using time windows defined
internally in the processor pf definition.   For variations (e.g.
adding tapering to one or more of the time series inputs)
use the d, wavelet, and (if required) noise arguments to load
each component separately.  Note d is dogmatically required
to be three component data while optional wavelet and noisedata
series are passed as plain numpy vectors (i.e. without the
decoration of a TimeSeries).</p>
<p>To make use of the extended outputs from RFdeconProcessor
algorithms (e.g. actual output of the computed operator)
call those methods after this function returns successfully
with a three-component seismogram output.  That is possible
because the processor object caches the most recent wavelet
and inverse used for the deconvolution.   An exception is
that all algorithms call their QCmetrics method of processor
and push them to the headers of the deconvolved output.
QCmetric attributes are algorithm dependent.</p>
<p>The ProcessingHistory feature can optionally be enabled by
setting the save_history argument to True.   When enable one should
normally set a unique id for the algid argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> – Seismogram input data.  See notes above about</p>
</dd>
</dl>
<p>time span of these data.
:param processor:  RFdeconProcessor object defining algorithm</p>
<blockquote>
<div><p>to be applied (see related documentation for details).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelet</strong> – vector of doubles (numpy array or the
std::vector container internal to TimeSeries object) defining
the wavelet to use to compute deconvolution operator.
Default is None which assumes processor was set up to use
a component of d as the wavelet estimate.</p></li>
<li><p><strong>noisedata</strong> – vector of doubles (numpy array or the
std::vector container internal to TimeSeries object) defining
noise data to use for computing regularization.  Not all RF
estimation algorithms use noise estimators so this parameter
is optional.   It can also be extracted from d depending on
parameter file options.</p></li>
<li><p><strong>wcomp</strong> – <p>When defined from Seismogram d the wavelet
estimate in conventional RFs is one of the components that
are most P wave dominated. That is always one of three
things:  Z, L of LQT, or the L component from the output of
Kennett’s free surface transformation operator.  The
default is 2, which for ccore.Seismogram is always one of
the above.   This parameter would be changed only if the
data has undergone some novel transformation not yet invented
and the best wavelet estimate was on in 2 (3 with FORTRAN
and matlab numbering).
:param ncomp: component number to use to compute noise.  This is used
only if the algorithm in processor requires a noise estimate.
Normally it should be the same as wcomp and is by default (2).
:param object_history: boolean to enable or disable saving object</p>
<blockquote>
<div><p>level history.  Default is False.  Note this functionality is
implemented via the mspass_func_wrapper decorator.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">param alg_name</dt>
<dd class="field-odd"><p>When history is enabled this is the algorithm name
assigned to the stamp for applying this algorithm.
Default (“WindowData”) should normally be just used.
Note this functionality is implemented via the mspass_func_wrapper decorator.</p>
</dd>
<dt class="field-even">param ald_id</dt>
<dd class="field-even"><p>algorithm id to assign to history record (used only if
object_history is set True.)
Note this functionality is implemented via the mspass_func_wrapper decorator.</p>
</dd>
<dt class="field-odd">param dryrun</dt>
<dd class="field-odd"><p>When true only the arguments are checked for validity.
When true nothing is calculated and the original data are returned.
Note this functionality is implemented via the mspass_func_wrapper decorator.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Seismogram object containing the RF estimates.
The orientations are always the same as the input.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor">
<em class="property">class </em><code class="sig-prename descclassname">mspasspy.algorithms.RFdeconProcessor.</code><code class="sig-name descname">RFdeconProcessor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alg</span><span class="o">=</span><span class="default_value">'LeastSquares'</span></em>, <em class="sig-param"><span class="n">pf</span><span class="o">=</span><span class="default_value">'RFdeconProcessor.pf'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/RFdeconProcessor.html#RFdeconProcessor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is a wrapper for the suite of receiver function deconvolution
methods we call scalar methods.  That is, the operation is reducable to
two time series:   wavelet signal and the data (TimeSeries) signal.
That is in contrast to three component methods that always treat the
data as vector samples.   The class should be created as a global
processor object to be used in a spark job.  The design assumes the
processor object will be passed as an argument to the RFdecon
function that should appear as a function in a spark map call.</p>
<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.QCMetrics">
<code class="sig-name descname">QCMetrics</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/RFdeconProcessor.html#RFdeconProcessor.QCMetrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.QCMetrics" title="Permalink to this definition">¶</a></dt>
<dd><p>All decon algorithms compute a set of algorithm dependent quality
control metrics.  This method returns the metrics as a set of fixed
name:value pairs in a mspass.Metadata object.   The details are
algorithm dependent.  See related documentation for metrics computed
by different algorithms.</p>
</dd></dl>

<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.actual_output">
<code class="sig-name descname">actual_output</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/RFdeconProcessor.html#RFdeconProcessor.actual_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.actual_output" title="Permalink to this definition">¶</a></dt>
<dd><p>The actual output of a decon operator is the inverse filter applied to
the wavelet.  By design it is an approximation of the shaping wavelet
defined for this operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Actual output of the operator as a ccore.TimeSeries object.</p>
</dd>
</dl>
<p>The Metadata of the return is bare bones.  The most important factor
about this result is that because actual output waveforms are normally
a zero phase wavelet of some kind the result is time shifted to be
centered (i.e. t0 is rounded n/2 where n is the length of the vector</p>
<blockquote>
<div><p>returned).</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/RFdeconProcessor.html#RFdeconProcessor.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.apply" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Compute the RF estimate using the algorithm defined internally.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>vector of data that are the RF estimate computed from previously loaded data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.change_parameters">
<code class="sig-name descname">change_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">md</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/RFdeconProcessor.html#RFdeconProcessor.change_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.change_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this method to change the internal parameter setting of the
processor.  It can be used, for example, to switch from the damped
least square method to the water level method.  Note the input
must be a complete definition for a parameter set defining a
particular algorithm.  i.e. this is not an update method but
t reinitializes the processor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>md</strong> – is a mspass.Metadata object containing required parameters</p>
</dd>
</dl>
<p>for the alternative algorithm.</p>
</dd></dl>

<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.dwin">
<em class="property">property </em><code class="sig-name descname">dwin</code><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.dwin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.ideal_output">
<code class="sig-name descname">ideal_output</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/RFdeconProcessor.html#RFdeconProcessor.ideal_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.ideal_output" title="Permalink to this definition">¶</a></dt>
<dd><p>The ideal output of a decon operator is the same thing we call a
shaping wavelet.  This method returns the ideal output=shaping wavelet
as a TimeSeries object.   Like the actual output method the return
function is circular shifted so the function peaks at 0 time located
at n/2 samples from the start sample.  Graphic displays will then show
the wavelet centered and peaked at time 0.   The prediction error
can be computed as the difference between the actual_output and
ideal_output TimeSeries objects.   The norm of the prediction error
is a helpful metric to display the stability and accuracy of the
inverse.</p>
</dd></dl>

<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.inverse_filter">
<code class="sig-name descname">inverse_filter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/RFdeconProcessor.html#RFdeconProcessor.inverse_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.inverse_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns the actual inverse filter that if convolved with
he original data will produce the RF estimate.  Note the filter is
meaningful only if the source wavelet is minimum phase.  A standard
theorem from time series analysis shows that the inverse of mixed
phase wavelet is usually unstable and a maximum phase wavelet is always
unstable.   Fourier-based methods can still compute a stable solution
even with a mixed phase wavelet because of the implied circular
convolution.</p>
<p>The result is returned as  TimeSeries object.</p>
</dd></dl>

<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.loaddata">
<code class="sig-name descname">loaddata</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'Seismogram'</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/RFdeconProcessor.html#RFdeconProcessor.loaddata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.loaddata" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads data for processing.  When window is set true
use the internal pf definition of data time window
and window the data.  The dtype parameter changes the
behavior of this algorithm significantly depending on
the setting.   It can be one of the following:
Seismogram, TimeSeries, or raw_vector.   For the first
two the data to process will be extracted in a
pf specfied window if window is True.  If window is
False TimeSeries data will be passed directly and
Seismogram data will have the data defined by the
component parameter copied to the internal data
vector workspace.   If dtype is set to raw_vector
d is assumed to be a raw numpy vector of doubles or
an the aliased std::vector used in ccore, for example,
in the TimeSeries object s vector.  Setting dtype
to raw_vector and window True will result in this
method throwing a RuntimeError exception as the
combination is not possible since raw_vector data
have no time base.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> – input data (contents expected depend upon</p>
</dd>
</dl>
<p>value of dtype parameter).
:param dtype: string defining the form d is expected</p>
<blockquote>
<div><p>to be (see details above)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component</strong> – component of Seismogram data to
load as data vector.  Ignored if dtype is raw_vector
or TimeSeries.</p></li>
<li><p><strong>window</strong> – boolean controlling internally
defined windowing.  (see details above)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nothing (not None nothing) is returned</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.loadnoise">
<code class="sig-name descname">loadnoise</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'Seismogram'</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/RFdeconProcessor.html#RFdeconProcessor.loadnoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.loadnoise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.loadwavelet">
<code class="sig-name descname">loadwavelet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">w</span></em>, <em class="sig-param"><span class="n">dtype</span><span class="o">=</span><span class="default_value">'Seismogram'</span></em>, <em class="sig-param"><span class="n">component</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/RFdeconProcessor.html#RFdeconProcessor.loadwavelet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.loadwavelet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.nwin">
<em class="property">property </em><code class="sig-name descname">nwin</code><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.nwin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.uses_noise">
<em class="property">property </em><code class="sig-name descname">uses_noise</code><a class="headerlink" href="#mspasspy.algorithms.RFdeconProcessor.RFdeconProcessor.uses_noise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mspasspy.algorithms.signals">
<span id="signals"></span><h2>signals<a class="headerlink" href="#module-mspasspy.algorithms.signals" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mspasspy.algorithms.signals.correlate">
<code class="sig-prename descclassname">mspasspy.algorithms.signals.</code><code class="sig-name descname">correlate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em>, <em class="sig-param"><span class="n">shift</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'correlate'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">demean</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">'naive'</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'auto'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/signals.html#correlate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.signals.correlate" title="Permalink to this definition">¶</a></dt>
<dd><p>Cross-correlation of two signals up to a specified maximal shift.
:param a: first signal
:param b: second signal
:param shift: Number of samples to shift for cross correlation. The cross-correlation will consist of 2*shift+1 or</p>
<blockquote>
<div><p>2*shift samples. The sample with zero shift will be in the middle.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object_history</strong> – True to preserve the processing history. For details, refer to
<a class="reference internal" href="mspasspy.util.html#mspasspy.util.decorators.mspass_func_wrapper_multi" title="mspasspy.util.decorators.mspass_func_wrapper_multi"><code class="xref py py-class docutils literal notranslate"><span class="pre">mspass_func_wrapper_multi</span></code></a>.</p></li>
<li><p><strong>alg_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – alg_name is the name the func we are gonna save while preserving the history.</p></li>
<li><p><strong>alg_id</strong> (<a class="reference external" href="https://pymongo.readthedocs.io/en/stable/api/bson/objectid.html#bson.objectid.ObjectId" title="(in PyMongo v3.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bson.objectid.ObjectId</span></code></a>) – alg_id is a unique id to record the usage of func while preserving the history.</p></li>
<li><p><strong>dryrun</strong> – True for dry-run, which return “OK”. Used in the mspass_func_wrapper.</p></li>
<li><p><strong>demean</strong> (<em>bool</em>) – Demean data beforehand.</p></li>
<li><p><strong>normalize</strong> – Method for normalization of cross-correlation. One of ‘naive’ or None (True and False are
supported for backwards compatibility). ‘naive’ normalizes by the overall standard deviation. None does not normalize.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Method to use to calculate the correlation. ‘direct’: The correlation is determined directly from
sums, the definition of correlation. ‘fft’ The Fast Fourier Transform is used to perform the correlation more
quickly. ‘auto’ Automatically chooses direct or Fourier method based on an estimate of which is faster.
(Only available for SciPy versions &gt;= 0.19. For older Scipy version method defaults to ‘fft’.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cross-correlation function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.signals.correlate_stream_template">
<code class="sig-prename descclassname">mspasspy.algorithms.signals.</code><code class="sig-name descname">correlate_stream_template</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stream</span></em>, <em class="sig-param"><span class="n">template</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'correlate_stream_template'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">template_time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_type</span><span class="o">=</span><span class="default_value">'seismogram'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/signals.html#correlate_stream_template"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.signals.correlate_stream_template" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.signals.correlate_template">
<code class="sig-prename descclassname">mspasspy.algorithms.signals.</code><code class="sig-name descname">correlate_template</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">template</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'correlate_template'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'valid'</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">'full'</span></em>, <em class="sig-param"><span class="n">demean</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'auto'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/signals.html#correlate_template"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.signals.correlate_template" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.signals.correlation_detector">
<code class="sig-prename descclassname">mspasspy.algorithms.signals.</code><code class="sig-name descname">correlation_detector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stream</span></em>, <em class="sig-param"><span class="n">templates</span></em>, <em class="sig-param"><span class="n">heights</span></em>, <em class="sig-param"><span class="n">distance</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'correlation_detector'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">template_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">template_magnitudes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">template_names</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">similarity_func</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">details</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_type</span><span class="o">=</span><span class="default_value">'seismogram'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/signals.html#correlation_detector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.signals.correlation_detector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.signals.detrend">
<code class="sig-prename descclassname">mspasspy.algorithms.signals.</code><code class="sig-name descname">detrend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'dtrend'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">inplace_return</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">type</span><span class="o">=</span><span class="default_value">'simple'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">options</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/signals.html#detrend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.signals.detrend" title="Permalink to this definition">¶</a></dt>
<dd><p>This function removes a trend from the data, which is a mspasspy object. Note it is wrapped by mspass_func_wrapper,
so the processing history and error logs can be preserved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input data, only mspasspy data objects are accepted, i.e. TimeSeries, Seismogram, Ensemble.</p></li>
<li><p><strong>type</strong> (<em>str</em>) – type of filter, ‘simple’, ‘linear’, ‘constant’, ‘polynomial’, ‘spline’. You can refer to
<cite>Obspy &lt;https://docs.obspy.org/packages/autogen/obspy.core.trace.Trace.detrend.html&gt;</cite> for details.</p></li>
<li><p><strong>args</strong> – extra arguments</p></li>
<li><p><strong>object_history</strong> – True to preserve the processing history. For details, refer to
<a class="reference internal" href="mspasspy.util.html#mspasspy.util.decorators.mspass_func_wrapper" title="mspasspy.util.decorators.mspass_func_wrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">mspass_func_wrapper</span></code></a>.</p></li>
<li><p><strong>alg_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – alg_name is the name the func we are gonna save while preserving the history.</p></li>
<li><p><strong>alg_id</strong> (<a class="reference external" href="https://pymongo.readthedocs.io/en/stable/api/bson/objectid.html#bson.objectid.ObjectId" title="(in PyMongo v3.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bson.objectid.ObjectId</span></code></a>) – alg_id is a unique id to record the usage of func while preserving the history.</p></li>
<li><p><strong>dryrun</strong> – True for dry-run, which return “OK”. Used in the mspass_func_wrapper.</p></li>
<li><p><strong>inplace_return</strong> – True to return data in mspass_func_wrapper.</p></li>
<li><p><strong>options</strong> – extra kv options</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.signals.filter">
<code class="sig-prename descclassname">mspasspy.algorithms.signals.</code><code class="sig-name descname">filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">type</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'filter'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">inplace_return</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">options</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/signals.html#filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.signals.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>This function filters the data of mspasspy objects. Note it is wrapped by mspass_func_wrapper, so the processing
history and error logs can be preserved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input data, only mspasspy data objects are accepted, i.e. TimeSeries, Seismogram, Ensemble.</p></li>
<li><p><strong>type</strong> (<em>str</em>) – type of filter, ‘bandpass’, ‘bandstop’, ‘lowpass’, ‘highpass’, ‘lowpass_cheby_2’, ‘lowpass_fir’,
‘remez_fir’. You can refer to
<cite>Obspy &lt;https://docs.obspy.org/packages/autogen/obspy.core.trace.Trace.filter.html&gt;</cite> for details.</p></li>
<li><p><strong>args</strong> – extra arguments</p></li>
<li><p><strong>object_history</strong> – True to preserve the processing history. For details, refer to
<a class="reference internal" href="mspasspy.util.html#mspasspy.util.decorators.mspass_func_wrapper" title="mspasspy.util.decorators.mspass_func_wrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">mspass_func_wrapper</span></code></a>.</p></li>
<li><p><strong>alg_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – alg_name is the name the func we are gonna save while preserving the history.</p></li>
<li><p><strong>alg_id</strong> (<a class="reference external" href="https://pymongo.readthedocs.io/en/stable/api/bson/objectid.html#bson.objectid.ObjectId" title="(in PyMongo v3.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bson.objectid.ObjectId</span></code></a>) – alg_id is a unique id to record the usage of func while preserving the history.</p></li>
<li><p><strong>dryrun</strong> – True for dry-run, which return “OK”. Used in the mspass_func_wrapper.</p></li>
<li><p><strong>inplace_return</strong> – True to return data in mspass_func_wrapper.</p></li>
<li><p><strong>options</strong> – extra kv options</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.signals.interpolate">
<code class="sig-prename descclassname">mspasspy.algorithms.signals.</code><code class="sig-name descname">interpolate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">sampling_rate</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'interpolate'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">inplace_return</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'weighted_average_slopes'</span></em>, <em class="sig-param"><span class="n">starttime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">npts</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time_shift</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/signals.html#interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.signals.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function interpolates data, which is a mspasspy object. Note it is wrapped by mspass_func_wrapper,
so the processing history and error logs can be preserved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input data, only mspasspy data objects are accepted, i.e. TimeSeries, Seismogram, Ensemble.</p></li>
<li><p><strong>sampling_rate</strong> – The new sampling rate in Hz.</p></li>
<li><p><strong>args</strong> – extra arguments.</p></li>
<li><p><strong>object_history</strong> – True to preserve the processing history. For details, refer to
<a class="reference internal" href="mspasspy.util.html#mspasspy.util.decorators.mspass_func_wrapper" title="mspasspy.util.decorators.mspass_func_wrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">mspass_func_wrapper</span></code></a>.</p></li>
<li><p><strong>alg_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – alg_name is the name the func we are gonna save while preserving the history.</p></li>
<li><p><strong>alg_id</strong> (<a class="reference external" href="https://pymongo.readthedocs.io/en/stable/api/bson/objectid.html#bson.objectid.ObjectId" title="(in PyMongo v3.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bson.objectid.ObjectId</span></code></a>) – alg_id is a unique id to record the usage of func while preserving the history.</p></li>
<li><p><strong>dryrun</strong> – True for dry-run, which return “OK”. Used in the mspass_func_wrapper.</p></li>
<li><p><strong>inplace_return</strong> – True to return data in mspass_func_wrapper.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – One of “linear”, “nearest”, “zero”, “slinear”, “quadratic”, “cubic”, “lanczos”,
or “weighted_average_slopes”. You can refer to
<cite>Obspy &lt;https://docs.obspy.org/packages/autogen/obspy.core.trace.Trace.interpolate.html&gt;</cite> for details.</p></li>
<li><p><strong>starttime</strong> (<a class="reference external" href="https://docs.obspy.org/packages/autogen/obspy.core.utcdatetime.UTCDateTime.html#obspy.core.utcdatetime.UTCDateTime" title="(in ObsPy Documentation (1.2.0) v1.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code></a> or int) – The start time (or timestamp) for the new interpolated stream.
Will be set to current start time of the data if not given.</p></li>
<li><p><strong>npts</strong> (<em>int</em>) – The new number of samples. Will be set to the best fitting number to retain the current end time
of the trace if not given.</p></li>
<li><p><strong>time_shift</strong> – Shift the trace by adding time_shift to the starttime. The time shift is always given in seconds.
A positive shift means the data is shifted towards the future, e.g. a positive time delta.
Note that this parameter solely affects the metadata. The actual interpolation of the underlaying data is governed
by the parameters sampling_rate, starttime and npts.</p></li>
<li><p><strong>kwargs</strong> – extra kv arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.signals.templates_max_similarity">
<code class="sig-prename descclassname">mspasspy.algorithms.signals.</code><code class="sig-name descname">templates_max_similarity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">st</span></em>, <em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">streams_templates</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'templates_max_similarity'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/signals.html#templates_max_similarity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.signals.templates_max_similarity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.signals.xcorr_3c">
<code class="sig-prename descclassname">mspasspy.algorithms.signals.</code><code class="sig-name descname">xcorr_3c</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">st1</span></em>, <em class="sig-param"><span class="n">st2</span></em>, <em class="sig-param"><span class="n">shift_len</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'xcor_3c'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">components</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">full_xcorr</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">abs_max</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/signals.html#xcorr_3c"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.signals.xcorr_3c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.signals.xcorr_max">
<code class="sig-prename descclassname">mspasspy.algorithms.signals.</code><code class="sig-name descname">xcorr_max</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'xcor_max'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">abs_max</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/signals.html#xcorr_max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.signals.xcorr_max" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.signals.xcorr_pick_correction">
<code class="sig-prename descclassname">mspasspy.algorithms.signals.</code><code class="sig-name descname">xcorr_pick_correction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trace1</span></em>, <em class="sig-param"><span class="n">trace2</span></em>, <em class="sig-param"><span class="n">pick1</span></em>, <em class="sig-param"><span class="n">pick2</span></em>, <em class="sig-param"><span class="n">t_before</span></em>, <em class="sig-param"><span class="n">t_after</span></em>, <em class="sig-param"><span class="n">cc_maxlag</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'xcorr_pick_correction'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">filter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filter_options</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/signals.html#xcorr_pick_correction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.signals.xcorr_pick_correction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-mspasspy.algorithms.window">
<span id="window"></span><h2>window<a class="headerlink" href="#module-mspasspy.algorithms.window" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mspasspy.algorithms.window.TopMute">
<em class="property">class </em><code class="sig-prename descclassname">mspasspy.algorithms.window.</code><code class="sig-name descname">TopMute</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t0</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">t1</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">type</span><span class="o">=</span><span class="default_value">'cosine'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/window.html#TopMute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.window.TopMute" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A top mute is a form of taper applied to the “front” of a signal.
Front in standard jargon means that with the time axis running from
left to right (normal unless your native language is Arabic) the time
period on the left side of a plot.   Data tagged at times less than what we
call the zero time here are always zeroed.  The mute defines a ramp function
running from the zero time to the “one” time.  In the ramp zone the
ramp function multiplies the sample data so it is a form of “taper” as
used in Fourier analysis.  This class should normally only be used on data with the time
reference type set Relative.  It can be applied to UTC time standard data but
with such data one of these objects would often need to be created for
each atomic data object, which would be horribly inefficient.  In most
cases conversion to relative time is an essential step before using
this algorithm.</p>
<p>This implementation uses an “apply” method for processing data.
That means for a parallel construct instead of the symbol for a function
you use the apply method as a function call.  (e.g. if tm is an is an
instance of this class and “d” is a TimeSeries or Seismogram object to be
muted the function call that applies the mute would be ts.apply(d))</p>
<dl class="py method">
<dt id="mspasspy.algorithms.window.TopMute.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">instance</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/window.html#TopMute.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.window.TopMute.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Use thie method to apply the defined top mute to one of the MsPASS
atomic data objects. The method does a sanity check on the input
data range.  If the starttime of the data is greater than t0 for
the mute the datum is killed and an error posted to elog.  The
reason is in that situation the data would be completely zeroed
anyway and it is better to define it dead and leave an error message
than to completely null data.
:param d:  input atomic MsPASS data object (TimeSeries or Seismogram)
:object_history:  It set true the function will add define this</p>
<blockquote>
<div><p>step as an map operation to preserve object level history.
(default is False)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>instance</strong> – string defining the “instance” of this algorithm.
This parameter is needed only if object_history is set True.  It
is used to define which instance of this algrithm is being applied.
(In the C++ api this is what is called the algorithm id).  I can
come from the global history manager or be set manually.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.window.WindowData">
<code class="sig-prename descclassname">mspasspy.algorithms.window.</code><code class="sig-name descname">WindowData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">twin</span></em>, <em class="sig-param"><span class="n">t0shift</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'scale'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/window.html#WindowData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.window.WindowData" title="Permalink to this definition">¶</a></dt>
<dd><p>Cut data defined by a TimeWindow object.</p>
<p>Cutting a smaller waveform segment from a larger waveform segment
is a very common seismic data processing task.   The function is
a python wrapper to adapt C++ code that accomplishes that task
to the MsPASS framework.</p>
<p>Note this function uses one model for being bombproof with a map
operation.  Any exception that makes the result invalid will cause
an error message to be posted to the elog attribute of the input
datum AND the data will be marked dead (killed).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> – is the input data.  d must be either a TimeSeries or Seismogram
object or the function will log an error to d and return a None.</p></li>
<li><p><strong>twin</strong> – is a TimeWindow defining window to be cut</p></li>
<li><p><strong>t0shift</strong> – is an optional time shift to apply to the time window.
This parameter is convenient to avoid conversions to relative time.
A typical example would be to set t0shift to an arrival time and let
the window define time relative to that arrival time.  Default is None
which cause the function to assume twin is to be used directly.</p></li>
<li><p><strong>object_history</strong> – boolean to enable or disable saving object
level history.  Default is False.  Note this functionality is
implemented via the mspass_func_wrapper decorator.</p></li>
<li><p><strong>alg_name</strong> – When history is enabled this is the algorithm name
assigned to the stamp for applying this algorithm.
Default (“WindowData”) should normally be just used.
Note this functionality is implemented via the mspass_func_wrapper decorator.</p></li>
<li><p><strong>ald_id</strong> – algorithm id to assign to history record (used only if
object_history is set True.)
Note this functionality is implemented via the mspass_func_wrapper decorator.</p></li>
<li><p><strong>dryrun</strong> – Note this functionality is implemented via the mspass_func_wrapper decorator.</p></li>
<li><p><strong>dryrun</strong> – Note this functionality is implemented via the mspass_func_wrapper decorator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>copy of d with sample range reduced to twin range.  Returns
an empty version of the parent data type (default constructor) if
the input is marked dead</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.window.ensemble_error_post">
<code class="sig-prename descclassname">mspasspy.algorithms.window.</code><code class="sig-name descname">ensemble_error_post</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">alg</span></em>, <em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">severity</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/window.html#ensemble_error_post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.window.ensemble_error_post" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a small helper function useful for error handlers in except
blocks for ensemble objects.  If a function is called on an ensemble
object that throws an exception this function will post the message
posted to all ensemble members.  It silently does nothing if the
ensemble is empty.
:param d: is the ensemble data to be handled.  It print and error message</p>
<blockquote>
<div><p>and returns doing nothing if d is not one of the known ensemble
objects.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alg</strong> – is the algorithm name posted to elog on each member</p></li>
<li><p><strong>message</strong> – is the string posted to all members</p></li>
<li><p><strong>severity</strong> – is the error severity level</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mspasspy.algorithms.window.scale">
<code class="sig-prename descclassname">mspasspy.algorithms.window.</code><code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">compute_from_window</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'peak'</span></em>, <em class="sig-param"><span class="n">level</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">scale_by_section</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_mean</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">object_history</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">alg_name</span><span class="o">=</span><span class="default_value">'scale'</span></em>, <em class="sig-param"><span class="n">alg_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dryrun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">function_return_key</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mspasspy/algorithms/window.html#scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mspasspy.algorithms.window.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Top level function interface to data scaling methods.</p>
<p>This function can be used to scale seismic data contained in any of
the four seismic data objects defined in mspass:  TimeSeries, Seismogram,
TimeSeriesEnsemble, and SeismogramEnsemble.   An extensive set of
amplitude estimation metrics are available by selecting one of the
allowed values for the method parameter.   Ensembles can be scaled
at the individual seismogram level or as a whole (scale_by_section=True).</p>
<p>Note all methods preserve the original amplitude by updating the
Metadata parameter calib to include the scaling.  i.e. as always the
amplitude of the data in physical units can be restored by multiplying
the data samples by calib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> – is input data object.  If not one of the four mspass seismic
data types noted above the function will throw a RuntimeError exception.</p></li>
<li><p><strong>compute_from_window</strong> – boolean used to compute amplitude and scale
based on a windowed section of the input waveform.   By default (this
boolan False) the amplitude for scaling is computed from the full
waveform.  When True the window argument must contain a valid TimeWindow
that spans a time range smaller than the data range.  In that situation
if the window is inconsistent with the data range the return will be
marked dead and messages will be found posted in elog.  For ensembles
all or only  portion of the group will be killed if this happens.
Note this parameter is also ignored when scale_by_section is true.</p></li>
<li><p><strong>window</strong> – mspass TimeWindow object defining the time range
over which the amplitude for scaling is to be computed.  (see the
compute_from_window parameter description)</p></li>
<li><p><strong>method</strong> – string defining the gain method to use.  Currently supported
method values are:  peak, RMS (rms accepted), perc, and MAD
(also accepts mad or Mad).  Peak uses the largest amplitude for
scaling.  For 3C data that means vector amplitude while for scalar data
it is the largest absolute value. rms is the standard rms measure,
although for 3C data is is rms vector amplitudes so scaling is by the
number of vectors not the total number of samples (3 times number of
vectors).  perc uses a sorted percentage clip level metric as used in
seismic unix.  mad is a variant where the value returned is the
median absolute deviation (mad) that is actual the same as perc=1/2.
Default is peak.  WARNING:  if an invalid value for method is passed the
data will be returned unaltered with a complaint message issue for
very datum (indivually or in ensembles) run that way.</p></li>
<li><p><strong>level</strong> – For all but perc this defines the scale to which the data
are scaled.  For perc it is used to set the percent clip level.
If the value passed is illegal (0 or negative for most methods while
perc must also be positive but less or equal 1) a complain message will
be posted to elog and the level adjusted to 1.0.</p></li>
<li><p><strong>scale_by_section</strong> – is a boolean that controls the scaling
behavior on ensembles only (It is silently ignored for atomic
TimeSeries and Seismogram data).  When true a single gain factor is
applied to all members of an ensemble.  When false each member is
gained individually as if this function were applied in a loop to
each member.</p></li>
<li><p><strong>use_mean</strong> – boolean used only for ensembles and when scale_by_section is
True.   The algorithm used in that case has an option to use the mean
log amplitude for scaling the section instead of the default median
amplitude.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Data scaled to specified level.  Note the scaling always preserves
absolute amplitude by adjusting the value of the calib attribute of the
return so calib*data is the same value before and after the scaling.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>same as input</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="mspasspy.ccore.html" class="btn btn-neutral float-right" title="mspasspy.ccore" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Python API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020-2021, Ian Wang.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>